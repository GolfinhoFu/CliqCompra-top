<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <title layout:title-pattern="$LAYOUT_TITLE - $CONTENT_TITLE">CliqCompra</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" />
    <!-- Other common head elements can go here -->
</head>
<body>
    <header>
        <div class="container">
            <h1>CliqCompra</h1>
            <nav>
                <ul>
                    <li><a th:href="@{/}">Home</a></li>
                    <li><a th:href="@{/produtos}">Products</a></li>

                    <!-- If user is NOT logged in -->
                    <li th:if="${!isUserLoggedIn}">
                        <a th:href="@{/registrar}">Register</a>
                    </li>
                    <li th:if="${!isUserLoggedIn}">
                        <a th:href="@{/login}">Login</a>
                    </li>

                    <!-- If user IS logged in -->
                    <th:block th:if="${isUserLoggedIn}">
                        <li>
                            <span style="color: #fff; margin-right: 15px;">
                                Welcome, <span th:text="${session.loggedInUserName != null ? session.loggedInUserName : loggedInUserEmail}"></span> (<span th:text="${loggedInUserType}"></span>)
                            </span>
                        </li>

                        <!-- Links for all logged-in users -->
                        <li><a th:href="@{/produtos/add}">Add Product</a></li>
                        <li><a th:href="@{/produtos/my}">My Products</a></li>

                        <!-- Cliente Specific Links (if they remain distinct) -->
                        <th:block th:if="${loggedInUserType == 'CLIENTE'}">
                            <li><a th:href="@{/cart}">My Cart</a></li>
                            <li><a th:href="@{/cliente/pedidos}">My Orders</a></li>
                        </th:block>
                        
                        <li>
                            <a th:href="@{/logout}">Logout</a>
                        </li>
                    </th:block>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- Page-specific content will be inserted here -->
        <section layout:fragment="content">
            <p>This is placeholder content from the layout file. It should be replaced by page-specific content.</p>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2023 CliqCompra. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
